import numpy as np

"""
check the accuracy of stiffness tensor C_ij
"""

C_noNPT = np.array([
 [897.82329412,141.56896708,199.26751157, 13.12594687,-17.6861354,18.58815175],
 [141.56896708,966.35511631,156.60170505, 14.92068253,13.38082028,-9.96728465],
 [199.26751157,156.60170505,972.02907393,-35.60267733,-24.62939909,32.0298576 ],
 [13.12594687,14.92068253,-35.60267733,669.35888793,-3.32401896,-12.23042416],
 [-17.6861354,13.38082028,-24.62939909,-3.32401896,721.65858819,-18.57972642],
 [18.58815175,-9.96728465,32.0298576,-12.23042416,-18.57972642,661.63543089]
])

C_NPT = np.array( [[ 8.87439363e+02 , 1.75402590e+02,  1.69911328e+02 ,-7.03820774e+00
,   2.49963753e+01, -1.20929608e-01],
 [ 1.75402590e+02,  9.26076659e+02,  2.19376540e+02 , 3.91215958e+01,
  -2.67188672e+01, -6.94389207e+00],
 [ 1.69911328e+02,  2.19376540e+02,  9.83838248e+02, -5.70338816e+00,
   1.68214357e+01, -2.21231119e+01],
 [-7.03820774e+00,  3.91215958e+01 ,-5.70338816e+00,  6.70960302e+02,
   2.18735534e+00, -3.61682650e+00],
 [ 2.49963753e+01, -2.67188672e+01 , 1.68214357e+01 , 2.18735534e+00,
   6.74035954e+02,  1.28799955e+01],
 [-1.20929608e-01, -6.94389207e+00, -2.21231119e+01 ,-3.61682650e+00,
   1.28799955e+01,  6.81365231e+02]])

# 对称性误差度量
def symmetry_metrics(C):
    # cubic expectation: C11=C22=C33, C12=C13=C23, C44=C55=C66; shear-normal cross terms = 0
    C11 = np.array([C[0,0], C[1,1], C[2,2]])
    C12s = np.array([C[0,1], C[0,2], C[1,2]])
    C44s = np.array([C[3,3], C[4,4], C[5,5]])
    shear_cross = np.array([C[0,3], C[0,4], C[0,5], C[1,3], C[1,4], C[1,5], C[2,3], C[2,4], C[2,5]])
    return {
        'C11_mean': C11.mean(), 'C11_std': C11.std(),
        'C12_mean': C12s.mean(), 'C12_std': C12s.std(),
        'C44_mean': C44s.mean(), 'C44_std': C44s.std(),
        'shear_cross_max_abs': np.max(np.abs(shear_cross))
    }

print(symmetry_metrics(C_NPT))
